using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Forms;
using StudyBuddy.Helpers;
using StudyBuddy.Models;
using Newtonsoft.Json;

namespace StudyBuddy.Controls
{
    /// <summary>
    /// Reverse Quiz Generator Control
    /// Generates multiple choice questions from user-provided answers/definitions
    /// </summary>
    public partial class ReverseQuizGenerator : UserControl, IThemeAware, IAsyncInitializable
    {
        #region Private Fields

        private readonly SettingsHandler _settingsHandler;
        private GeminiApiClient? _geminiClient;
        private string _currentApiKey = string.Empty;
        private ThemeColors _themeColors;
        
        private List<dynamic> _generatedQuestions = new List<dynamic>();
        private int _currentQuestionIndex = 0;
        private int _correctAnswers = 0;
        private int _totalAnswered = 0;

        #endregion

        #region Constructor

        public ReverseQuizGenerator(SettingsHandler settingsHandler)
        {
            _settingsHandler = settingsHandler;
            InitializeComponent();
        }

        #endregion

        #region Interface Implementations

        public async Task InitializeAsync()
        {
            await LoadSettingsAsync();
            InitializeControls();
        }

        public void OnThemeChanged(ThemeColors themeColors)
        {
            _themeColors = themeColors;
            ApplyTheme();
        }

        #endregion

        #region Initialization

        private async Task LoadSettingsAsync()
        {
            try
            {
                var settings = await _settingsHandler.LoadSettingsAsync();
                
                if (!string.IsNullOrEmpty(settings.ApiKey))
                {
                    _currentApiKey = settings.ApiKey;
                    _geminiClient = new GeminiApiClient(_currentApiKey);
                    lblApiStatus.Text = "AI Ready";
                    lblApiStatus.ForeColor = Color.Green;
                }
                else
                {
                    lblApiStatus.Text = "Configure API";
                    lblApiStatus.ForeColor = Color.Red;
                }
            }
            catch (Exception ex)
            {
                lblApiStatus.Text = $"Error: {ex.Message}";
                lblApiStatus.ForeColor = Color.Red;
            }
        }

        private void InitializeControls()
        {
            UpdateButtonStates();
            ShowInstructions();
        }

        private void ApplyTheme()
        {
            if (_themeColors != null)
            {
                this.BackColor = _themeColors.Background;
                this.ForeColor = _themeColors.Text;
                
                groupAnswers.BackColor = _themeColors.Surface;
                groupQuiz.BackColor = _themeColors.Surface;
                groupResults.BackColor = _themeColors.Surface;
                
                txtAnswers.BackColor = _themeColors.Background;
                txtAnswers.ForeColor = _themeColors.Text;
                panelQuestion.BackColor = _themeColors.Surface;
            }
        }

        #endregion

        #region Event Handlers

        private async void btnGenerateQuiz_Click(object sender, EventArgs e)
        {
            if (_geminiClient == null)
            {
                MessageBox.Show("Please configure your API key first.", "API Key Required", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }

            if (string.IsNullOrWhiteSpace(txtAnswers.Text))
            {
                MessageBox.Show("Please enter some answers or definitions first.", "Input Required", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }

            try
            {
                btnGenerateQuiz.Text = "Generating...";
                btnGenerateQuiz.Enabled = false;
                Cursor = Cursors.WaitCursor;

                var answers = txtAnswers.Text.Trim();
                var result = await _geminiClient.GenerateReverseQuizAsync(answers);
                
                // Parse the JSON response
                var questions = JsonConvert.DeserializeObject<List<dynamic>>(result);
                
                if (questions != null && questions.Count > 0)
                {
                    _generatedQuestions = questions;
                    _currentQuestionIndex = 0;
                    _correctAnswers = 0;
                    _totalAnswered = 0;
                    
                    ShowQuestion();
                    UpdateResults();
                }
                else
                {
                    MessageBox.Show("No questions were generated. Please try with different answers.", "Generation Failed", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Error generating quiz: {ex.Message}", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            finally
            {
                btnGenerateQuiz.Text = "Generate Quiz";
                btnGenerateQuiz.Enabled = true;
                Cursor = Cursors.Default;
            }
        }

        private void btnOption1_Click(object sender, EventArgs e) => CheckAnswer(0);
        private void btnOption2_Click(object sender, EventArgs e) => CheckAnswer(1);
        private void btnOption3_Click(object sender, EventArgs e) => CheckAnswer(2);
        private void btnOption4_Click(object sender, EventArgs e) => CheckAnswer(3);

        private void btnNext_Click(object sender, EventArgs e)
        {
            if (_currentQuestionIndex < _generatedQuestions.Count - 1)
            {
                _currentQuestionIndex++;
                ShowQuestion();
            }
        }

        private void btnPrevious_Click(object sender, EventArgs e)
        {
            if (_currentQuestionIndex > 0)
            {
                _currentQuestionIndex--;
                ShowQuestion();
            }
        }

        private void btnRestart_Click(object sender, EventArgs e)
        {
            _currentQuestionIndex = 0;
            _correctAnswers = 0;
            _totalAnswered = 0;
            
            if (_generatedQuestions.Count > 0)
            {
                ShowQuestion();
                UpdateResults();
            }
        }

        private async void btnExport_Click(object sender, EventArgs e)
        {
            if (_generatedQuestions.Count == 0)
            {
                MessageBox.Show("Generate a quiz first before exporting.", "No Quiz Available", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }

            using (var saveDialog = new SaveFileDialog())
            {
                saveDialog.Filter = "PDF files (*.pdf)|*.pdf|Text files (*.txt)|*.txt";
                saveDialog.DefaultExt = "pdf";
                saveDialog.FileName = $"ReverseQuiz_{DateTime.Now:yyyyMMdd_HHmmss}";

                if (saveDialog.ShowDialog() == DialogResult.OK)
                {
                    try
                    {
                        var content = GenerateExportContent();
                        
                        if (saveDialog.FilterIndex == 1) // PDF
                        {
                            await ExportHelper.ExportToPdfAsync(content, "Reverse Quiz", saveDialog.FileName);
                        }
                        else // Text file
                        {
                            await System.IO.File.WriteAllTextAsync(saveDialog.FileName, content);
                        }
                        
                        MessageBox.Show("Quiz exported successfully!", "Export Complete", MessageBoxButtons.OK, MessageBoxIcon.Information);
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show($"Error exporting quiz: {ex.Message}", "Export Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                }
            }
        }

        private void txtAnswers_TextChanged(object sender, EventArgs e)
        {
            UpdateButtonStates();
        }

        #endregion

        #region Helper Methods

        private void ShowInstructions()
        {
            lblQuestion.Text = "Enter answers or definitions in the text area above, then click 'Generate Quiz' to create multiple choice questions!";
            
            btnOption1.Text = "Ready to start?";
            btnOption2.Text = "Enter your answers";
            btnOption3.Text = "Generate questions";
            btnOption4.Text = "Begin quiz!";
            
            DisableOptionButtons();
            lblQuestionNumber.Text = "Instructions";
            lblExplanation.Text = "This tool will automatically create multiple choice questions from your answers or definitions. Perfect for testing your knowledge!";
        }

        private void ShowQuestion()
        {
            if (_generatedQuestions.Count == 0 || _currentQuestionIndex >= _generatedQuestions.Count)
            {
                ShowInstructions();
                return;
            }

            var question = _generatedQuestions[_currentQuestionIndex];
            
            lblQuestion.Text = question.question?.ToString() ?? "Question not available";
            lblQuestionNumber.Text = $"Question {_currentQuestionIndex + 1} of {_generatedQuestions.Count}";
            
            var options = question.options;
            if (options != null && options.Count >= 4)
            {
                btnOption1.Text = options[0]?.ToString() ?? "Option 1";
                btnOption2.Text = options[1]?.ToString() ?? "Option 2";
                btnOption3.Text = options[2]?.ToString() ?? "Option 3";
                btnOption4.Text = options[3]?.ToString() ?? "Option 4";
            }
            
            EnableOptionButtons();
            ResetOptionColors();
            lblExplanation.Text = "Choose the correct answer:";
            
            UpdateNavigationButtons();
        }

        private void CheckAnswer(int selectedOption)
        {
            if (_currentQuestionIndex >= _generatedQuestions.Count) return;
            
            var question = _generatedQuestions[_currentQuestionIndex];
            var correctIndex = question.correct_index ?? question.answer_index ?? 0;
            
            _totalAnswered++;
            
            if (selectedOption == correctIndex)
            {
                _correctAnswers++;
                HighlightCorrectAnswer(selectedOption);
                lblExplanation.Text = $"? Correct! {question.explanation ?? ""}";
                lblExplanation.ForeColor = Color.Green;
            }
            else
            {
                HighlightIncorrectAnswer(selectedOption, correctIndex);
                lblExplanation.Text = $"? Incorrect. The correct answer was option {correctIndex + 1}. {question.explanation ?? ""}";
                lblExplanation.ForeColor = Color.Red;
            }
            
            DisableOptionButtons();
            UpdateResults();
            
            // Auto-advance after 2 seconds
            var timer = new System.Windows.Forms.Timer();
            timer.Interval = 2000;
            timer.Tick += (s, e) =>
            {
                timer.Stop();
                timer.Dispose();
                if (_currentQuestionIndex < _generatedQuestions.Count - 1)
                {
                    btnNext_Click(null, null);
                }
            };
            timer.Start();
        }

        private void EnableOptionButtons()
        {
            btnOption1.Enabled = true;
            btnOption2.Enabled = true;
            btnOption3.Enabled = true;
            btnOption4.Enabled = true;
        }

        private void DisableOptionButtons()
        {
            btnOption1.Enabled = false;
            btnOption2.Enabled = false;
            btnOption3.Enabled = false;
            btnOption4.Enabled = false;
        }

        private void ResetOptionColors()
        {
            btnOption1.BackColor = Color.FromArgb(158, 158, 158);
            btnOption2.BackColor = Color.FromArgb(158, 158, 158);
            btnOption3.BackColor = Color.FromArgb(158, 158, 158);
            btnOption4.BackColor = Color.FromArgb(158, 158, 158);
            
            lblExplanation.ForeColor = _themeColors?.Text ?? Color.Black;
        }

        private void HighlightCorrectAnswer(int index)
        {
            var buttons = new[] { btnOption1, btnOption2, btnOption3, btnOption4 };
            if (index >= 0 && index < buttons.Length)
            {
                buttons[index].BackColor = Color.FromArgb(76, 175, 80);
            }
        }

        private void HighlightIncorrectAnswer(int selectedIndex, int correctIndex)
        {
            var buttons = new[] { btnOption1, btnOption2, btnOption3, btnOption4 };
            
            if (selectedIndex >= 0 && selectedIndex < buttons.Length)
            {
                buttons[selectedIndex].BackColor = Color.FromArgb(244, 67, 54);
            }
            
            if (correctIndex >= 0 && correctIndex < buttons.Length)
            {
                buttons[correctIndex].BackColor = Color.FromArgb(76, 175, 80);
            }
        }

        private void UpdateNavigationButtons()
        {
            btnPrevious.Enabled = _currentQuestionIndex > 0;
            btnNext.Enabled = _currentQuestionIndex < _generatedQuestions.Count - 1;
        }

        private void UpdateResults()
        {
            var percentage = _totalAnswered > 0 ? (double)_correctAnswers / _totalAnswered * 100 : 0;
            
            lblResults.Text = $"Results:\n" +
                             $"Answered: {_totalAnswered}/{_generatedQuestions.Count}\n" +
                             $"Correct: {_correctAnswers}\n" +
                             $"Accuracy: {percentage:F1}%";
        }

        private void UpdateButtonStates()
        {
            bool hasApiKey = !string.IsNullOrWhiteSpace(_currentApiKey);
            bool hasAnswers = !string.IsNullOrWhiteSpace(txtAnswers.Text);
            
            btnGenerateQuiz.Enabled = hasApiKey && hasAnswers;
        }

        private string GenerateExportContent()
        {
            var content = "# Reverse Quiz Generated by Study Buddy Pro\n\n";
            content += $"Generated on: {DateTime.Now:MMMM dd, yyyy}\n";
            content += $"Total Questions: {_generatedQuestions.Count}\n\n";
            
            for (int i = 0; i < _generatedQuestions.Count; i++)
            {
                var question = _generatedQuestions[i];
                content += $"## Question {i + 1}\n\n";
                content += $"{question.question}\n\n";
                
                var options = question.options;
                if (options != null)
                {
                    for (int j = 0; j < options.Count; j++)
                    {
                        var letter = (char)('A' + j);
                        content += $"{letter}. {options[j]}\n";
                    }
                }
                
                var correctIndex = question.correct_index ?? question.answer_index ?? 0;
                var correctLetter = (char)('A' + correctIndex);
                content += $"\n**Correct Answer: {correctLetter}**\n";
                
                if (!string.IsNullOrEmpty(question.explanation?.ToString()))
                {
                    content += $"Explanation: {question.explanation}\n";
                }
                
                content += "\n---\n\n";
            }
            
            return content;
        }

        #endregion

        #region Designer Code

        private void InitializeComponent()
        {
            this.tableLayoutMain = new TableLayoutPanel();
            this.groupAnswers = new GroupBox();
            this.lblInstructions = new Label();
            this.txtAnswers = new TextBox();
            this.btnGenerateQuiz = new Button();
            this.lblApiStatus = new Label();
            this.groupResults = new GroupBox();
            this.lblResults = new Label();
            this.btnRestart = new Button();
            this.btnExport = new Button();
            this.groupQuiz = new GroupBox();
            this.panelQuestion = new Panel();
            this.lblQuestionNumber = new Label();
            this.lblQuestion = new Label();
            this.panelOptions = new Panel();
            this.btnOption1 = new Button();
            this.btnOption2 = new Button();
            this.btnOption3 = new Button();
            this.btnOption4 = new Button();
            this.lblExplanation = new Label();
            this.panelNavigation = new Panel();
            this.btnPrevious = new Button();
            this.btnNext = new Button();

            this.tableLayoutMain.SuspendLayout();
            this.groupAnswers.SuspendLayout();
            this.groupResults.SuspendLayout();
            this.groupQuiz.SuspendLayout();
            this.panelQuestion.SuspendLayout();
            this.panelOptions.SuspendLayout();
            this.panelNavigation.SuspendLayout();
            this.SuspendLayout();

            // tableLayoutMain
            this.tableLayoutMain.ColumnCount = 2;
            this.tableLayoutMain.ColumnStyles.Add(new ColumnStyle(SizeType.Absolute, 300F));
            this.tableLayoutMain.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 100F));
            this.tableLayoutMain.Controls.Add(this.groupAnswers, 0, 0);
            this.tableLayoutMain.Controls.Add(this.groupResults, 0, 1);
            this.tableLayoutMain.Controls.Add(this.groupQuiz, 1, 0);
            this.tableLayoutMain.Dock = DockStyle.Fill;
            this.tableLayoutMain.Name = "tableLayoutMain";
            this.tableLayoutMain.RowCount = 2;
            this.tableLayoutMain.RowStyles.Add(new RowStyle(SizeType.Percent, 70F));
            this.tableLayoutMain.RowStyles.Add(new RowStyle(SizeType.Percent, 30F));
            this.tableLayoutMain.SetRowSpan(this.groupQuiz, 2);
            this.tableLayoutMain.Size = new Size(1000, 700);
            this.tableLayoutMain.TabIndex = 0;

            // groupAnswers
            this.groupAnswers.Controls.Add(this.lblInstructions);
            this.groupAnswers.Controls.Add(this.txtAnswers);
            this.groupAnswers.Controls.Add(this.btnGenerateQuiz);
            this.groupAnswers.Controls.Add(this.lblApiStatus);
            this.groupAnswers.Dock = DockStyle.Fill;
            this.groupAnswers.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.groupAnswers.Location = new Point(4, 4);
            this.groupAnswers.Name = "groupAnswers";
            this.groupAnswers.Padding = new Padding(15);
            this.groupAnswers.Size = new Size(292, 482);
            this.groupAnswers.TabIndex = 0;
            this.groupAnswers.TabStop = false;
            this.groupAnswers.Text = "Input Answers";

            // lblInstructions
            this.lblInstructions.Font = new Font("Segoe UI", 9F);
            this.lblInstructions.Location = new Point(20, 35);
            this.lblInstructions.Name = "lblInstructions";
            this.lblInstructions.Size = new Size(250, 60);
            this.lblInstructions.Text = "Enter answers, definitions, or facts below. The AI will generate multiple choice questions from them.";

            // txtAnswers
            this.txtAnswers.Font = new Font("Segoe UI", 10F);
            this.txtAnswers.Location = new Point(20, 100);
            this.txtAnswers.Multiline = true;
            this.txtAnswers.Name = "txtAnswers";
            this.txtAnswers.PlaceholderText = "Example:\nParis is the capital of France\nThe chemical symbol for water is H2O\nShakespeare wrote Romeo and Juliet";
            this.txtAnswers.ScrollBars = ScrollBars.Vertical;
            this.txtAnswers.Size = new Size(250, 280);
            this.txtAnswers.TabIndex = 1;
            this.txtAnswers.TextChanged += this.txtAnswers_TextChanged;

            // btnGenerateQuiz
            this.btnGenerateQuiz.BackColor = Color.FromArgb(33, 150, 243);
            this.btnGenerateQuiz.Enabled = false;
            this.btnGenerateQuiz.FlatStyle = FlatStyle.Flat;
            this.btnGenerateQuiz.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.btnGenerateQuiz.ForeColor = Color.White;
            this.btnGenerateQuiz.Location = new Point(20, 395);
            this.btnGenerateQuiz.Name = "btnGenerateQuiz";
            this.btnGenerateQuiz.Size = new Size(250, 40);
            this.btnGenerateQuiz.Text = "Generate Quiz";
            this.btnGenerateQuiz.UseVisualStyleBackColor = false;
            this.btnGenerateQuiz.Click += this.btnGenerateQuiz_Click;

            // lblApiStatus
            this.lblApiStatus.AutoSize = true;
            this.lblApiStatus.Font = new Font("Segoe UI", 9F);
            this.lblApiStatus.Location = new Point(20, 450);
            this.lblApiStatus.Name = "lblApiStatus";
            this.lblApiStatus.Size = new Size(75, 15);
            this.lblApiStatus.Text = "AI Status: --";

            // groupResults
            this.groupResults.Controls.Add(this.lblResults);
            this.groupResults.Controls.Add(this.btnRestart);
            this.groupResults.Controls.Add(this.btnExport);
            this.groupResults.Dock = DockStyle.Fill;
            this.groupResults.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.groupResults.Location = new Point(4, 492);
            this.groupResults.Name = "groupResults";
            this.groupResults.Padding = new Padding(15);
            this.groupResults.Size = new Size(292, 204);
            this.groupResults.TabIndex = 1;
            this.groupResults.TabStop = false;
            this.groupResults.Text = "Quiz Results";

            // lblResults
            this.lblResults.Font = new Font("Segoe UI", 10F);
            this.lblResults.Location = new Point(20, 35);
            this.lblResults.Name = "lblResults";
            this.lblResults.Size = new Size(250, 80);
            this.lblResults.Text = "Results:\nAnswered: 0/0\nCorrect: 0\nAccuracy: 0%";

            // btnRestart
            this.btnRestart.BackColor = Color.FromArgb(255, 152, 0);
            this.btnRestart.FlatStyle = FlatStyle.Flat;
            this.btnRestart.Font = new Font("Segoe UI", 10F, FontStyle.Bold);
            this.btnRestart.ForeColor = Color.White;
            this.btnRestart.Location = new Point(20, 125);
            this.btnRestart.Name = "btnRestart";
            this.btnRestart.Size = new Size(110, 35);
            this.btnRestart.Text = "Restart";
            this.btnRestart.UseVisualStyleBackColor = false;
            this.btnRestart.Click += this.btnRestart_Click;

            // btnExport
            this.btnExport.BackColor = Color.FromArgb(76, 175, 80);
            this.btnExport.FlatStyle = FlatStyle.Flat;
            this.btnExport.Font = new Font("Segoe UI", 10F, FontStyle.Bold);
            this.btnExport.ForeColor = Color.White;
            this.btnExport.Location = new Point(140, 125);
            this.btnExport.Name = "btnExport";
            this.btnExport.Size = new Size(110, 35);
            this.btnExport.Text = "Export";
            this.btnExport.UseVisualStyleBackColor = false;
            this.btnExport.Click += this.btnExport_Click;

            // groupQuiz
            this.groupQuiz.Controls.Add(this.panelQuestion);
            this.groupQuiz.Controls.Add(this.panelOptions);
            this.groupQuiz.Controls.Add(this.lblExplanation);
            this.groupQuiz.Controls.Add(this.panelNavigation);
            this.groupQuiz.Dock = DockStyle.Fill;
            this.groupQuiz.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.groupQuiz.Location = new Point(304, 4);
            this.groupQuiz.Name = "groupQuiz";
            this.groupQuiz.Padding = new Padding(15);
            this.groupQuiz.Size = new Size(692, 692);
            this.groupQuiz.TabIndex = 2;
            this.groupQuiz.TabStop = false;
            this.groupQuiz.Text = "Quiz Questions";

            // panelQuestion
            this.panelQuestion.BackColor = Color.White;
            this.panelQuestion.BorderStyle = BorderStyle.FixedSingle;
            this.panelQuestion.Controls.Add(this.lblQuestionNumber);
            this.panelQuestion.Controls.Add(this.lblQuestion);
            this.panelQuestion.Location = new Point(20, 35);
            this.panelQuestion.Name = "panelQuestion";
            this.panelQuestion.Padding = new Padding(20);
            this.panelQuestion.Size = new Size(650, 150);
            this.panelQuestion.TabIndex = 0;

            // lblQuestionNumber
            this.lblQuestionNumber.AutoSize = true;
            this.lblQuestionNumber.Font = new Font("Segoe UI", 10F, FontStyle.Bold);
            this.lblQuestionNumber.ForeColor = Color.FromArgb(33, 150, 243);
            this.lblQuestionNumber.Location = new Point(10, 10);
            this.lblQuestionNumber.Name = "lblQuestionNumber";
            this.lblQuestionNumber.Size = new Size(100, 19);
            this.lblQuestionNumber.Text = "Question 1 of 5";

            // lblQuestion
            this.lblQuestion.Font = new Font("Segoe UI", 12F);
            this.lblQuestion.Location = new Point(10, 40);
            this.lblQuestion.Name = "lblQuestion";
            this.lblQuestion.Size = new Size(620, 90);
            this.lblQuestion.Text = "Question will appear here...";

            // panelOptions
            this.panelOptions.Controls.Add(this.btnOption1);
            this.panelOptions.Controls.Add(this.btnOption2);
            this.panelOptions.Controls.Add(this.btnOption3);
            this.panelOptions.Controls.Add(this.btnOption4);
            this.panelOptions.Location = new Point(20, 200);
            this.panelOptions.Name = "panelOptions";
            this.panelOptions.Size = new Size(650, 200);
            this.panelOptions.TabIndex = 1;

            // btnOption1
            this.btnOption1.BackColor = Color.FromArgb(158, 158, 158);
            this.btnOption1.FlatStyle = FlatStyle.Flat;
            this.btnOption1.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.btnOption1.ForeColor = Color.White;
            this.btnOption1.Location = new Point(0, 10);
            this.btnOption1.Name = "btnOption1";
            this.btnOption1.Size = new Size(320, 40);
            this.btnOption1.Text = "A. Option 1";
            this.btnOption1.TextAlign = ContentAlignment.MiddleLeft;
            this.btnOption1.UseVisualStyleBackColor = false;
            this.btnOption1.Click += this.btnOption1_Click;

            // btnOption2
            this.btnOption2.BackColor = Color.FromArgb(158, 158, 158);
            this.btnOption2.FlatStyle = FlatStyle.Flat;
            this.btnOption2.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.btnOption2.ForeColor = Color.White;
            this.btnOption2.Location = new Point(330, 10);
            this.btnOption2.Name = "btnOption2";
            this.btnOption2.Size = new Size(320, 40);
            this.btnOption2.Text = "B. Option 2";
            this.btnOption2.TextAlign = ContentAlignment.MiddleLeft;
            this.btnOption2.UseVisualStyleBackColor = false;
            this.btnOption2.Click += this.btnOption2_Click;

            // btnOption3
            this.btnOption3.BackColor = Color.FromArgb(158, 158, 158);
            this.btnOption3.FlatStyle = FlatStyle.Flat;
            this.btnOption3.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.btnOption3.ForeColor = Color.White;
            this.btnOption3.Location = new Point(0, 60);
            this.btnOption3.Name = "btnOption3";
            this.btnOption3.Size = new Size(320, 40);
            this.btnOption3.Text = "C. Option 3";
            this.btnOption3.TextAlign = ContentAlignment.MiddleLeft;
            this.btnOption3.UseVisualStyleBackColor = false;
            this.btnOption3.Click += this.btnOption3_Click;

            // btnOption4
            this.btnOption4.BackColor = Color.FromArgb(158, 158, 158);
            this.btnOption4.FlatStyle = FlatStyle.Flat;
            this.btnOption4.Font = new Font("Segoe UI", 11F, FontStyle.Bold);
            this.btnOption4.ForeColor = Color.White;
            this.btnOption4.Location = new Point(330, 60);
            this.btnOption4.Name = "btnOption4";
            this.btnOption4.Size = new Size(320, 40);
            this.btnOption4.Text = "D. Option 4";
            this.btnOption4.TextAlign = ContentAlignment.MiddleLeft;
            this.btnOption4.UseVisualStyleBackColor = false;
            this.btnOption4.Click += this.btnOption4_Click;

            // lblExplanation
            this.lblExplanation.Font = new Font("Segoe UI", 10F);
            this.lblExplanation.Location = new Point(20, 410);
            this.lblExplanation.Name = "lblExplanation";
            this.lblExplanation.Size = new Size(650, 60);
            this.lblExplanation.Text = "Select an answer to see explanation...";

            // panelNavigation
            this.panelNavigation.Controls.Add(this.btnPrevious);
            this.panelNavigation.Controls.Add(this.btnNext);
            this.panelNavigation.Location = new Point(20, 480);
            this.panelNavigation.Name = "panelNavigation";
            this.panelNavigation.Size = new Size(650, 50);
            this.panelNavigation.TabIndex = 3;

            // btnPrevious
            this.btnPrevious.BackColor = Color.FromArgb(158, 158, 158);
            this.btnPrevious.Enabled = false;
            this.btnPrevious.FlatStyle = FlatStyle.Flat;
            this.btnPrevious.Font = new Font("Segoe UI", 10F, FontStyle.Bold);
            this.btnPrevious.ForeColor = Color.White;
            this.btnPrevious.Location = new Point(250, 5);
            this.btnPrevious.Name = "btnPrevious";
            this.btnPrevious.Size = new Size(120, 40);
            this.btnPrevious.Text = "< Previous";
            this.btnPrevious.UseVisualStyleBackColor = false;
            this.btnPrevious.Click += this.btnPrevious_Click;

            // btnNext
            this.btnNext.BackColor = Color.FromArgb(158, 158, 158);
            this.btnNext.Enabled = false;
            this.btnNext.FlatStyle = FlatStyle.Flat;
            this.btnNext.Font = new Font("Segoe UI", 10F, FontStyle.Bold);
            this.btnNext.ForeColor = Color.White;
            this.btnNext.Location = new Point(380, 5);
            this.btnNext.Name = "btnNext";
            this.btnNext.Size = new Size(120, 40);
            this.btnNext.Text = "Next >";
            this.btnNext.UseVisualStyleBackColor = false;
            this.btnNext.Click += this.btnNext_Click;

            // ReverseQuizGenerator
            this.Controls.Add(this.tableLayoutMain);
            this.Name = "ReverseQuizGenerator";
            this.Size = new Size(1000, 700);

            this.tableLayoutMain.ResumeLayout(false);
            this.groupAnswers.ResumeLayout(false);
            this.groupAnswers.PerformLayout();
            this.groupResults.ResumeLayout(false);
            this.groupQuiz.ResumeLayout(false);
            this.panelQuestion.ResumeLayout(false);
            this.panelQuestion.PerformLayout();
            this.panelOptions.ResumeLayout(false);
            this.panelNavigation.ResumeLayout(false);
            this.ResumeLayout(false);
        }

        #endregion

        #region Controls

        private TableLayoutPanel tableLayoutMain;
        private GroupBox groupAnswers;
        private Label lblInstructions;
        private TextBox txtAnswers;
        private Button btnGenerateQuiz;
        private Label lblApiStatus;
        private GroupBox groupResults;
        private Label lblResults;
        private Button btnRestart;
        private Button btnExport;
        private GroupBox groupQuiz;
        private Panel panelQuestion;
        private Label lblQuestionNumber;
        private Label lblQuestion;
        private Panel panelOptions;
        private Button btnOption1;
        private Button btnOption2;
        private Button btnOption3;
        private Button btnOption4;
        private Label lblExplanation;
        private Panel panelNavigation;
        private Button btnPrevious;
        private Button btnNext;

        #endregion
    }
}